<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js ie6" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8" lang="en"> <![endif]-->
<!--[if gt IE 8]><!-->  <html class="no-js" lang="en"> <!--<![endif]-->
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	
	<title>Getting Started with deck.js</title>
	
	<!-- Core and extension CSS files -->
	<link rel="stylesheet" href="deckjs/core/deck.core.css">
	<link rel="stylesheet" href="deckjs/extensions/goto/deck.goto.css">
	<link rel="stylesheet" href="deckjs/extensions/menu/deck.menu.css">
	<link rel="stylesheet" href="deckjs/extensions/navigation/deck.navigation.css">
	<link rel="stylesheet" href="deckjs/extensions/status/deck.status.css">
	<link rel="stylesheet" href="deckjs/extensions/hash/deck.hash.css">
	
	<!-- Theme CSS files (menu swaps these out) -->
	<link rel="stylesheet" id="style-theme-link" href="deckjs/themes/style/web-2.0.css">
	<link rel="stylesheet" id="transition-theme-link" href="deckjs/themes/transition/horizontal-slide.css">
	
	<!-- Custom CSS just for this page -->
	<link rel="stylesheet" href="css/introduction.css">
	<link rel="stylesheet" href="deckjs/themes/style/swiss.css">
	<link rel="stylesheet" href="css/slideshow.css">
	
	<script src="js/modernizr.custom.js"></script>

  <!-- Popcorn scripts -->
  <script src="popcornjs/popcorn.js"></script>
  <script src="popcornjs/plugin.deckjs.js"></script>
  <script src="popcornjs/parser.deckjs.js"></script>
  <!-- project-container class determines the size of the container.
       This contains the slideshow, media element, and transcript
       deck-container will override height set by deckjs to whatever you desire
  -->
  <style>
    .project-container {
      width: 100%;
      height: 98%;
    }
    .deck-container {
      height: 86%;
    }
  </style>
</head>

<body class="project-container">
<div class="deck-container">
  <section class="slide" id="title-slide" popcorn-slideshow="1">
    <h1>Firefox Hacking</h1>
    <h3>David Seifried</h3>
    <div class="transcript">
      Hi
    </div>
  </section>

  <section class="slide" id="bugs" popcorn-slideshow="4">
    <div class="transcript">
      Doesn't mess up at the top of the slide either
    </div>
    <h2>Currently working on:</h2>
    <ol>
      <li>
      <h3><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=702161">Bug 702161</a></h3>
        <p>videocontrols.xml has anonymous function event listeners that are added but never removed</p>
      </li>
      <li>
      <h3><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=708814">Bug 708814</a></h3>
        <p>Should fade out videocontrols even if there's no mouse movement</p>
      </li>
      <li>
      <h3><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=680321">Bug 680321</a></h3>
        <p>Media preload state should reset in resource selection algorithm</p>
      </li>
    </ol>
  </section>

  <section class="slide" id="bug702161" popcorn-slideshow="8">
    <div class="transcript">
      <a href="http://google.ca">Here have this link</a>
    </div>
    <h2>Bug 702161</h2>
    <h3>videocontrols.xml has anonymous function event listeners that are added but never removed</h3>
    <br/>
    <p>In second stage of review - First review by Jared Weins, waiting on review by Justin Dolske</p>
    <pre><code>if (!this.isAudioOnly) {
    this.muteButton.addEventListener("mouseover",  function(e) {
      self.onVolumeMouseInOut(e);
    }, false);
    this.muteButton.addEventListener("mouseout",   function(e) {
      self.onVolumeMouseInOut(e);
    }, false);
    this.volumeStack.addEventListener("mouseover", function(e) {
      self.onVolumeMouseInOut(e);
    }, false);
    this.volumeStack.addEventListener("mouseout",  function(e) {
      self.onVolumeMouseInOut(e);
    }, false);
  }

  this.videocontrols.addEventListener("transitionend", function(e) {
    self.onTransitionEnd(e);
   }, false);

  // Make the &lt;video&gt; element keyboard accessible.
  this.video.setAttribute("tabindex", 0);
  this.video.addEventListener("keypress", function (e) {
    self.keyHandler(e)
  }, false);</code></pre>
  </section>

  <section class="slide" id="702161fix" popcorn-slideshow="11">
    <div class="transcript">
      data
    </div>
    <h2>The fix</h2>
    <ul>
    <li>Store references to each anonymous function</li>
    <li>Remove these listeners in terminate function</li>
    <li>Minimize repated code</li>
  </ul>
    <pre><code> // Helper function to add an event listener to the given element
  function addListener(elem, eventName, func) {
    self.controlListeners.push({ item: elem, event: eventName, fnc: func });
    elem.addEventListener(eventName, func, false);
  }

  addListener(this.muteButton, "command", this.toggleMute.bind(this)); 
  addListener(this.playButton, "command", this.togglePause.bind(this));</code></pre>
  </section>

  <section class="slide" id="702161fixcont" popcorn-slideshow="14">
    <h2>The fix cont.</h2>
    <p>Removing listeners inside terminate function</p>
    <pre><code>for each(let element in this.controlListeners)
    element.item.removeEventListener(element.event, element.fnc, false);

  delete this.controlListeners;</code></pre>
    <div class="transcript">
      More data
    </div>
  </section>

  <section class="slide" id="bug708814" popcorn-slideshow="18">
    <h2>Bug 708814</h2>
    <h3>Should fade out videocontrols even if there's no mouse movement</h3>
    <a href="http://pearce.org.nz/full-screen/">Demo</a>
    <div class="transcript">
      Lorem ipsum dolor sit amet, adipiscing aenean semper dignissim in in, in nullam quam, vel esse eget turpis aliquam, nulla tellus vivamus mollis commodo dolor, suspendisse massa nonummy facilisis id. Sagittis eget eget in duis, orci diam lacus vivamus, elit lorem. Odio tempor, a vel morbi malesuada leo, aliquam nulla, est feugiat class dictum suspendisse tortor, aenean arcu elit leo amet. Dignissim iaculis donec ac dictumst non turpis, ornare curabitur. Porta mauris viverra, nonummy leo aliquam consequat dolor quis. Orci et adipiscing sapien, tincidunt sed ac erat fermentum, velit augue vitae magna massa, et elit amet sapien wisi lobortis, vestibulum irure mauris id duis. Turpis nec, amet suspendisse ullamcorper sollicitudin, vel a eros integer et, eget quam suspendisse, a interdum porta eu elit a ante. Ullamcorper massa volutpat elementum, nunc nam lacus nulla, elit morbi id convallis eget, id rhoncus. Elit arcu sed, bibendum tellus enim.
      In tortor diam nunc, eleifend pede ante sed neque, a ipsum diam ac facilisi bibendum. Adipiscing imperdiet cursus lectus velit elementum at, accumsan donec accumsan. Nihil aenean vel adipiscing sed auctor, dolor erat nec purus justo nunc, sociosqu eros erat. Velit ligula netus dui mattis nibh gravida, vitae integer primis suspendisse, et non justo, urna metus nulla odio. Senectus nulla sit condimentum justo nulla mauris. Felis nec, consectetuer ut senectus consequat scelerisque velit luctus, vehicula praesent libero et. Faucibus sollicitudin velit lorem, fringilla sagittis vestibulum.
      Orci nibh ex rhoncus molestie ante condimentum, hendrerit arcu augue ut at sapiente, ac rhoncus accumsan vulputate consectetuer condimentum venenatis, ultricies nec duis suscipit orci dui quam, quam egestas sociosqu condimentum amet urna donec. Nec suscipit, nunc massa ipsum vitae in ligula lobortis, et vitae facilisis mi quam ut nibh, ac semper sed a diam, est curabitur in ante. Curabitur ligula lacinia proin nec, libero amet mauris pellentesque elit vestibulum et. Ipsum sollicitudin possimus integer quisque morbi, aliquam a tortor accumsan condimentum tellus, duis ut vestibulum pede lectus cras donec. Maecenas orci dapibus nullam suscipit augue. Magna praesent sodales laoreet fusce lobortis arcu, ac quis ornare in aute nulla, morbi in eget, conubia amet blandit eum maecenas a. Sagittis curabitur sed enim elit, ut tortor auctor mollis odio mattis, adipiscing metus in vestibulum. Massa in nulla sed nec mauris, id placerat, et turpis augue sit turpis maecenas quis. Dui feugiat dolor, malesuada tincidunt eu tincidunt dolor. Suspendisse sollicitudin at wisi eu ligula sollicitudin, cras aenean penatibus velit magna scelerisque, congue ac vitae eleifend. In consectetuer ut dolor id purus.
      Ante et sollicitudin sed elit risus, et egestas. Nascetur leo justo viverra sollicitudin mauris, bibendum donec non, leo vitae, sed massa ut wisi venenatis mauris vestibulum, vivamus viverra lorem penatibus dignissim in. Nulla sit libero ultricies donec nam fusce, risus non tempor semper magna, lectus placerat hendrerit, pede feugiat. Felis feugiat lorem purus, sit a aenean, vulputate malesuada nunc integer eu metus. Odio et donec quis libero a tortor, et duis quam dui. Libero porta facilisis quam nulla, aenean tristique fusce, sem leo tincidunt eros etiam.
    </div>
  </section>

  <section class="slide" id="708814code" popcorn-slideshow="36">
    <h2>The fix</h2>
    <ul>
      <li>Make sure when full screen is triggered that the controls hide themselves</li>
    <li>Fix should workwith both fullscreen button click and triggered via a hotkey ( "k" in the prior demo )</li>
    <li>Tests to prove my fix does what it says</li>
    <pre><code>this.video.ownerDocument.addEventListener( "mozfullscreenchange", function(e) {
    clearTimeout(this._hideControlsTimeout);
    if(self.isVideoInFullScreen() &amp;&amp; self.video.mozMatchesSelector("video:hover")) {
      self._hideControlsTimeout = setTimeout(self._hideControlsFn, self.HIDE_CONTROLS_TIMEOUT_MS);
    }
  }, false);</code></pre>
  </section>

  <section class="slide" id="708814todo" popcorn-slideshow="45">
    <h2>To Do</h2>
    <ul>
      <li>Write tests</li>
      <li>Found out about i<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=708553">bug 708553</a> - picked it up</li>
    <li>Possibly blocked by 708553?</li>
    <ul>
  </section>

  <section class="slide" id="bug680321" popcorn-slideshow="56">
    <h2>Bug 680321</h2>
    <h3>Media preload state should reset in resource selection algorithm</h3>
    <br/>
    <p>Currently requesting feedback - potential fix, no tests</p>
  </section>

  <section class="slide" id="680321fix" popcorn-slideshow="70">
    <h2>The fix</h2>
    <p>Removed some code in resource selection algorithm that prevented preload states with less aggressive buffering to proceed</p>
    <a href="https://bugzilla.mozilla.org/attachment.cgi?id=554292">Test case</a>
    <a href="https://bugzilla.mozilla.org/attachment.cgi?id=591687&action=diff">Diff of code</a>
  </section>

  <section class="slide" id="680321todo" popcorn-slideshow="80">
    <h2>To Do</h2>
    <ul>
      <li>Create tests</li>
      <li>Wait for feedback</li>
    </ul>
  </section>

  <section class="slide" id="thankyou" popcorn-slideshow="90">
    <h1>Thank You!</h1>
  </section>

<p class="deck-status">
	<span class="deck-status-current"></span>
	/
	<span class="deck-status-total"></span>
</p>

<a href="#" class="deck-prev-link" title="Previous">&#8592;</a>
<a href="#" class="deck-next-link" title="Next">&#8594;</a>

</div>
<audio id="audio" controls class="media" style="width:100%;">
  <source src="media/italia.ogg"/>
</audio>
<div id="events" style="width:100%;height:3%;"></div>
<div id="slideshow-transcript" class="popcorn-transcript"></div>

  <!-- Grab CDN jQuery, with a protocol relative URL; fall back to local if offline -->
  <script src="//ajax.aspnetcdn.com/ajax/jQuery/jquery-1.7.min.js"></script>
  <script>window.jQuery || document.write('<script src="js/jquery-1.7.min.js"><\/script>')</script>

<!-- Deck Core and extensions -->
<script src="deckjs/core/deck.core.js"></script>
<script src="deckjs/extensions/hash/deck.hash.js"></script>
<script src="deckjs/extensions/menu/deck.menu.js"></script>
<script src="deckjs/extensions/goto/deck.goto.js"></script>
<script src="deckjs/extensions/status/deck.status.js"></script>
<script src="deckjs/extensions/navigation/deck.navigation.js"></script>

<!-- Specific to this page -->
<script src="js/introduction.js"></script>

</body>
</html>
